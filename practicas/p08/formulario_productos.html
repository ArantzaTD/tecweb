<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Registro de productos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif}
    body{margin:0;background:#f7f7f9}
    .wrap{max-width:760px;margin:36px auto;padding:22px;background:#fff;border:1px solid #e5e7eb;border-radius:12px}
    h1{margin:0 0 12px;font-size:1.25rem}
    form{display:grid;gap:14px}
    label{font-weight:600;display:block;margin-bottom:6px}
    .row{display:grid;gap:12px}
    @media (min-width:640px){ .row.cols-2{grid-template-columns:1fr 1fr} }
    input, textarea{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font:inherit}
    input:focus, textarea:focus{outline:2px solid #2563eb33;border-color:#2563eb}
    textarea{min-height:90px;resize:vertical}
    .note{font-size:.85rem;color:#6b7280;margin-top:4px}
    .actions{display:flex;gap:10px;margin-top:6px}
    button{padding:10px 16px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
    .primary{background:#2563eb;color:#fff}
    .ghost{background:#f3f4f6}
  </style>
</head>
<body>
  <main class="wrap">
    <h1>Registro de producto</h1>

    <form id="frmProducto"
          action="http://localhost/tecweb/practicas/p09/set_producto_v2.php"
          method="post" accept-charset="utf-8" autocomplete="on">

      <div class="row cols-2">
        <div>
          <label for="nombre">Nombre *</label>
          <input id="nombre" name="nombre" type="text" required
                 maxlength="100"
                 pattern="^[\p{L}\p{N}\s\-\._#/&\(\)]+$"
                 title="Solo letras, números y signos comunes (.,-_#/&())"
                 placeholder="Ej. Laptop 14&quot;">
          <div class="note">Máx. 100 caracteres.</div>
        </div>

        <div>
          <label for="marca">Marca *</label>
          <input id="marca" name="marca" type="text" required
                 maxlength="50"
                 pattern="^[\p{L}\p{N}\s\-\._#/&\(\)]+$"
                 title="Solo letras, números y signos comunes"
                 placeholder="Ej. Lenovo">
          <div class="note">Máx. 50 caracteres.</div>
        </div>
      </div>

      <div class="row cols-2">
        <div>
          <label for="modelo">Modelo *</label>
          <input id="modelo" name="modelo" type="text" required
                 maxlength="50"
                 pattern="^[\p{L}\p{N}\-._#\/]+$"
                 title="Letras, números y -,._#/"
                 placeholder="Ej. L14-G3">
          <div class="note">Máx. 50 caracteres.</div>
        </div>

        <div>
          <label for="precio">Precio (MXN) *</label>
          <input id="precio" name="precio" type="number" required
                 inputmode="decimal" step="0.01" min="0" placeholder="Ej. 12999.99">
        </div>
      </div>

      <div class="row cols-2">
        <div>
          <label for="unidades">Unidades *</label>
          <input id="unidades" name="unidades" type="number" required
                 inputmode="numeric" step="1" min="0" placeholder="Ej. 10">
        </div>

        <div>
          <label for="imagen">Imagen (ruta o nombre)</label>
          <input id="imagen" name="imagen" type="text" maxlength="255"
                 pattern="^$|^.+\.(png|jpg|jpeg|gif)$"
                 title="Deja vacío o termina en .png, .jpg, .jpeg o .gif"
                 placeholder="Ej. src/imagen.png">
          <div class="note">Coloca tu archivo en <code>tecweb/practicas/p08/src/imagen.png</code> y usa esa ruta.</div>
        </div>
      </div>

      <div>
        <label for="detalles">Detalles</label>
        <textarea id="detalles" name="detalles" maxlength="255"
                  placeholder="Descripción breve (máx. 255 caracteres)"></textarea>
      </div>

      <div class="actions">
        <button class="primary" type="submit">Guardar producto</button>
        <button class="ghost" type="reset">Limpiar</button>
      </div>
    </form>
  </main>

  <script>
    const $ = (s)=>document.querySelector(s);
    const patterns = {
      textoComun: /^[\p{L}\p{N}\s\-._#\/&()]+$/u,
      modelo: /^[\p{L}\p{N}\-._#\/]+$/u,
      imagen: /(^$)|(.+\.(png|jpg|jpeg|gif)$)/i
    };
    const trim = (s)=> (s||"").trim();

    $("#frmProducto").addEventListener("submit", (e)=>{
      const nombre   = trim($("#nombre").value);
      const marca    = trim($("#marca").value);
      const modelo   = trim($("#modelo").value);
      const precio   = parseFloat($("#precio").value);
      const unidades = parseInt($("#unidades").value,10);
      const detalles = trim($("#detalles").value);
      const imagen   = trim($("#imagen").value);

      if (!nombre || nombre.length>100 || !patterns.textoComun.test(nombre)) { e.preventDefault(); alert("Nombre inválido."); return; }
      if (!marca  || marca.length>50  || !patterns.textoComun.test(marca))   { e.preventDefault(); alert("Marca inválida."); return; }
      if (!modelo || modelo.length>50 || !patterns.modelo.test(modelo))      { e.preventDefault(); alert("Modelo inválido."); return; }
      if (isNaN(precio) || precio<0)   { e.preventDefault(); alert("Precio inválido."); return; }
      if (!Number.isInteger(unidades) || unidades<0) { e.preventDefault(); alert("Unidades inválidas."); return; }
      if (detalles.length>255)         { e.preventDefault(); alert("Detalles excede 255."); return; }
      if (!patterns.imagen.test(imagen)) { e.preventDefault(); alert("Imagen debe ser .png/.jpg/.jpeg/.gif o vacía."); return; }

      $("#nombre").value=nombre; $("#marca").value=marca; $("#modelo").value=modelo;
      $("#detalles").value=detalles; $("#imagen").value=imagen;
    });
  </script>
</body>
</html>
